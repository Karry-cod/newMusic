<template>
    <div class="body boxSide">
        <!-- 歌单信息 -->
        <div class="head">
            <div :style="{ 'background-image': 'url(' + sheetInfo.sheetImg + ')' }"></div>
            <div>
                <div class="sheetName">{{ sheetInfo.name }}</div>
                <div>
                    <img src="@/assets/imgs/wangyiyun.png" alt=""> <span
                        style="font-size:0.2rem;margin-right: 30px;color:gray">网易云官方音乐</span>
                    <span v-for="item in sheetInfo.tags" class="sheetTags">#{{ item }} </span>
                </div>
                <div class="sheetInfo">
                    <p>
                        {{ sheetInfo.information }}
                    </p>
                </div>
                <div class="sheet_btn">
                    <button @click="playAllSong()">
                        <el-icon size="1.3rem" style="transform:translateY(0.3rem);margin-right:5px">
                            <VideoPlay></VideoPlay>
                        </el-icon>
                        <span style="margin-bottom: 5px;display:inline-block">播放全部</span>
                    </button>
                    <button @mouseenter="loveHover()" @mouseleave="loveLeave()" @click="loveSheet()">
                        <div class="img" :style="'background-image:url(' + love_img + ')'"></div>
                        <span style="margin-bottom: 5px;display:inline-block">收藏</span>
                    </button>
                    <div class="more"></div>
                </div>
            </div>
        </div>
        <!-- 歌曲 / 评论 - 列表 -->
        <div>
            <el-tabs v-model="activeName" class="demo-tabs">
                <el-tab-pane label="歌曲" name="song">
                    <div class="tab">
                        <el-table @cell-dblclick="playSong" :data="showMusicTable" row-style="border:0px"
                            highlight-current-row="true" row-class-name="table_tr" style="width: 100%">
                            <el-table-column prop="name" label="歌曲" />
                            <el-table-column width="150">
                                <template #default="scope">
                                    <div class="musicBtns">
                                        <div @click="Store.player.playSong(scope.row)"></div>
                                        <div></div>
                                        <div></div>
                                        <div></div>
                                    </div>
                                </template>
                            </el-table-column>
                            <el-table-column prop="author" label="歌手" />
                            <el-table-column prop="album" label="专辑" />
                            <el-table-column label="时长" width="100">
                                <template #default="scope">
                                    <span>
                                        {{ repairZero(parseInt((scope.row.time / 60000 - 1).toFixed(0))) }}:
                                        {{ repairZero(parseInt((scope.row.time / 1000 % 60).toFixed(0))) }}
                                    </span>
                                </template>
                            </el-table-column>
                        </el-table>
                        <div class="showMore">
                            <span v-if="showMore" style="cursor: pointer;" @click="showMoreMusic()">加载更多</span>
                        </div>
                    </div>
                </el-tab-pane>
                <el-tab-pane label="评论" name="communicaty">
                    <div class="tab comment_Outside">
                        <el-input v-model="comment.myComment" :rows="3" maxlength="140" show-word-limit type="textarea"
                            placeholder="请写下你的评论叭~" />
                        <div style="display:flex">
                            <div style="width:10%">
                                <span class="commentBtns">#</span>
                                <span class="commentBtns">@</span>
                            </div>
                            <div style="width:100%;text-align:right;padding-top:10px">
                                <span class="pushComment" @click="sendComment(1)">评论</span>
                            </div>
                        </div>
                        <!-- 热评 -->
                        <div class="hotComment_outside">
                            <span class="title">热评</span>
                            <div class="comment_contain">
                                <div class="comment_line" v-for="item in comment.hotComment" :key="item.commentId">
                                    <div>
                                        <img :src="item.user.avatarUrl" alt="">
                                    </div>
                                    <div>
                                        <span class="nickname">{{ item.user.nickname }}：</span>
                                        <span>{{ item.content }}</span>
                                        <!-- 被回复的评论 -->
                                        <div class="beReplieComment" v-if="item.beReplied.length > 0">
                                            <div v-for="comment in item.beReplied" :key="comment.beRepliedCommentId">
                                                <span class="nickname">@{{ comment.user.nickname }}：</span>
                                                <span>{{ comment.content }}</span>
                                            </div>
                                        </div>
                                        <!-- 评论时间 - 评论操作 -->
                                        <div>
                                            <div style="width: 50%;">
                                                {{ item.timeStr }}
                                            </div>
                                            <div class="comment_btns">
                                                <div style="display:flex;position:absolute;right:0px">
                                                    <div class="report">
                                                        举报
                                                    </div>
                                                    <div>
                                                        <span>
                                                            <svg t="1677639165647" class="icon" viewBox="0 0 1024 1024"
                                                                version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2806"
                                                                width="20" height="20">
                                                                <path
                                                                    d="M190.193225 471.411583c14.446014 0 26.139334-11.718903 26.139334-26.13831 0-14.44499-11.69332-26.164916-26.139334-26.164916-0.271176 0-0.490164 0.149403-0.73678 0.149403l-62.496379 0.146333c-1.425466-0.195451-2.90005-0.295735-4.373611-0.295735-19.677155 0-35.621289 16.141632-35.621289 36.114522L86.622358 888.550075c0 19.949354 15.96767 35.597753 35.670407 35.597753 1.916653 0 3.808746 0.292666 5.649674 0l61.022819 0.022513c0.099261 0 0.148379 0.048095 0.24764 0.048095 0.097214 0 0.146333-0.048095 0.24457-0.048095l0.73678 0 0-0.148379c13.413498-0.540306 24.174586-11.422144 24.174586-24.960485 0-13.55983-10.760065-24.441669-24.174586-24.981974l0-0.393973-50.949392 0 1.450025-402.275993L190.193225 471.409536z"
                                                                    p-id="2807"></path>
                                                                <path
                                                                    d="M926.52241 433.948343c-19.283182-31.445176-47.339168-44.172035-81.289398-45.546336-1.77032-0.246617-3.536546-0.39295-5.380544-0.39295l-205.447139-0.688685c13.462616-39.059598 22.698978-85.58933 22.698978-129.317251 0-28.349675-3.193739-55.962569-9.041934-82.542948l-0.490164 0.049119c-10.638291-46.578852-51.736315-81.31498-100.966553-81.31498-57.264215 0-95.466282 48.15065-95.466282 106.126063 0 3.241834-0.294712 6.387477 0 9.532097-2.996241 108.386546-91.240027 195.548698-196.23636 207.513194l0 54.881958-0.785899 222.227314 0 229.744521 10.709923 0 500.025271 0.222057 8.746198-0.243547c19.35686 0.049119 30.239721-4.817726 47.803749-16.116049 16.682961-10.761088 29.236881-25.50079 37.490869-42.156122 2.260483-3.341095 4.028757-7.075139 5.106298-11.20111l77.018118-344.324116c1.056052-4.053316 1.348718-8.181333 1.056052-12.160971C943.643346 476.446249 938.781618 453.944769 926.52241 433.948343zM893.82573 486.837924l-82.983993 367.783411-0.099261-0.049119c-2.555196 6.141884-6.879688 11.596106-12.872169 15.427364-4.177136 2.727111-8.773827 4.351098-13.414521 4.964058-1.49812-0.195451-3.046383 0-4.620227 0l-477.028511-0.540306-0.171915-407.408897c89.323375-40.266076 154.841577-79.670527 188.596356-173.661202 0.072655 0.024559 0.124843 0.049119 0.195451 0.072655 2.99931-9.137101 6.313799-20.73423 8.697079-33.164331 5.551436-29.185716 5.258771-58.123792 5.258771-58.123792-4.937452-37.98001 25.940812-52.965306 44.364417-52.965306 25.304316 0.860601 50.263777 33.656541 50.263777 52.326762 0 0 5.600555 27.563776 5.649674 57.190537 0.048095 37.366026-4.6673 56.847729-4.6673 56.847729l-0.466628 0c-5.872754 30.879288-16.214287 60.138682-30.464849 86.964654l0.36839 0.342808c-2.358721 4.815679-3.709485 10.220782-3.709485 15.943111 0 19.922748 19.088754 21.742187 38.765909 21.742187l238.761895 0.270153c0 0 14.666024 0.465604 14.690584 0.465604l0 0.100284c12.132318-0.638543 24.221658 5.207605 31.100322 16.409738 5.504364 9.016351 6.437619 19.6045 3.486404 28.988218L893.82573 486.837924z"
                                                                    p-id="2808"></path>
                                                                <path
                                                                    d="M264.827039 924.31872c0.319272 0.024559 0.441045 0.024559 0.295735-0.024559 0.243547-0.048095 0.367367-0.074701-0.295735-0.074701s-0.539282 0.026606-0.271176 0.074701C264.43409 924.343279 264.532327 924.343279 264.827039 924.31872z"
                                                                    p-id="2809"></path>
                                                            </svg>
                                                        </span>
                                                        <span style="transform: translateY(-5px);display: inline-block;">{{
                                                            item.likedCount
                                                        }}</span>
                                                    </div>
                                                    <div>
                                                        <svg t="1677641270520" class="icon" viewBox="0 0 1024 1024"
                                                            version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3792"
                                                            width="20" height="20">
                                                            <path
                                                                d="M785.066667 529.408c0-9.443556 5.006222-18.204444 13.198222-22.869333 8.192-4.778667 18.318222-4.778667 26.396444 0 8.192 4.778667 13.198222 13.425778 13.198223 22.869333V684.942222c0 88.177778-71.452444 159.744-159.744 159.744H345.201778C257.024 844.686222 185.457778 773.233778 185.457778 684.942222V351.914667c0-88.177778 71.452444-159.744 159.744-159.744h144.611555c14.563556 0 26.510222 11.832889 26.510223 26.396444 0 14.563556-11.832889 26.396444-26.510223 26.396445H345.201778c-28.330667 0-55.523556 11.264-75.548445 31.288888a106.876018 106.876018 0 0 0-31.288889 75.548445v333.027555c0 28.330667 11.264 55.523556 31.288889 75.548445 20.024889 20.024889 47.217778 31.288889 75.548445 31.288889h333.027555c58.936889 0 106.837333-47.786667 106.837334-106.837334V529.408z"
                                                                p-id="3793"></path>
                                                            <path
                                                                d="M678.229333 855.153778H345.201778c-93.752889 0-170.097778-76.344889-170.097778-170.097778V351.914667c0-93.752889 76.344889-170.097778 170.097778-170.097778h144.611555c20.366222 0 36.864 16.497778 36.864 36.864s-16.497778 36.864-36.864 36.864H345.201778c-25.713778 0-49.948444 10.012444-68.152889 28.216889s-28.216889 42.439111-28.216889 68.152889V684.942222c0 25.713778 10.012444 49.948444 28.216889 68.152889s42.439111 28.216889 68.152889 28.216889h333.027555c53.134222 0 96.369778-43.235556 96.369778-96.369778V529.408c0-13.084444 7.054222-25.372444 18.432-31.971556 5.575111-3.185778 11.946667-4.892444 18.432-4.892444s12.856889 1.706667 18.432 4.892444c11.377778 6.599111 18.432 18.773333 18.432 31.971556V684.942222c0 93.866667-76.231111 170.211556-170.097778 170.211556zM345.201778 202.638222c-82.261333 0-149.276444 67.015111-149.276445 149.276445V684.942222c0 82.261333 67.015111 149.276444 149.276445 149.276445h333.027555c82.261333 0 149.276444-67.015111 149.276445-149.276445V529.408c0-5.688889-3.072-11.036444-8.078222-13.880889-4.892444-2.844444-11.150222-2.844444-16.042667 0-4.892444 2.844444-7.964444 8.192-7.964445 13.880889V684.942222c0 64.625778-52.565333 117.191111-117.191111 117.191111H345.201778c-31.288889 0-60.757333-12.174222-82.830222-34.360889-22.186667-22.186667-34.360889-51.541333-34.360889-82.830222V351.914667c0-31.288889 12.174222-60.757333 34.360889-82.830223 22.186667-22.186667 51.541333-34.360889 82.830222-34.360888h144.611555c8.874667 0 16.042667-7.168 16.042667-16.042667s-7.168-16.042667-16.042667-16.042667H345.201778zM785.066667 245.191111H645.006222c-14.563556 0-26.396444-11.832889-26.396444-26.396444 0-14.563556 11.832889-26.396444 26.396444-26.396445h166.570667c14.563556 0 26.510222 11.832889 26.510222 26.396445v166.570666c0 9.443556-5.006222 18.204444-13.198222 22.869334-8.192 4.778667-18.318222 4.778667-26.396445 0-8.192-4.778667-13.198222-13.425778-13.198222-22.869334V245.191111z"
                                                                p-id="3794"></path>
                                                            <path
                                                                d="M811.463111 420.522667c-6.144 0-12.288-1.592889-17.635555-4.664889-10.808889-6.257778-17.635556-17.976889-17.635556-30.492445V253.952H645.006222c-19.456 0-35.271111-15.815111-35.271111-35.271111s15.815111-35.271111 35.271111-35.271111h166.570667c19.456 0 35.271111 15.815111 35.271111 35.271111v166.570667c0 12.515556-6.712889 24.234667-17.635556 30.492444-5.461333 3.072-11.605333 4.778667-17.749333 4.778667zM645.006222 201.045333c-9.784889 0-17.635556 7.964444-17.635555 17.635556 0 9.784889 7.964444 17.635556 17.635555 17.635555h148.821334v148.821334c0 6.257778 3.413333 12.174222 8.874666 15.36 5.347556 3.072 12.288 3.072 17.635556 0 5.461333-3.185778 8.874667-8.988444 8.874666-15.36V218.680889c0-9.784889-7.964444-17.635556-17.635555-17.635556H645.006222z"
                                                                p-id="3795"></path>
                                                            <path
                                                                d="M530.432 537.144889c-10.467556 9.671111-26.624 9.443556-36.750222-0.682667-10.126222-10.126222-10.353778-26.282667-0.682667-36.750222l299.804445-299.804444c10.467556-9.671111 26.624-9.443556 36.750222 0.682666 10.126222 10.126222 10.353778 26.282667 0.682666 36.750222L530.432 537.144889z m0 0"
                                                                p-id="3796"></path>
                                                            <path
                                                                d="M512.341333 553.073778c-9.443556 0-18.204444-3.640889-24.917333-10.353778a35.180089 35.180089 0 0 1-0.910222-48.924444l0.227555-0.227556 299.918223-299.918222 0.113777-0.113778c6.485333-6.144 15.018667-9.443556 24.007111-9.443556 9.443556 0 18.204444 3.640889 24.917334 10.353778a35.180089 35.180089 0 0 1 0.910222 48.924445l-0.227556 0.227555-299.918222 299.918222-0.113778 0.113778c-6.485333 6.030222-15.018667 9.443556-24.007111 9.443556z m-12.970666-47.217778c-6.371556 7.054222-6.257778 17.749333 0.568889 24.462222 3.299556 3.299556 7.736889 5.233778 12.515555 5.233778 4.437333 0 8.647111-1.706667 11.946667-4.664889l299.576889-299.576889c6.371556-7.054222 6.257778-17.749333-0.568889-24.462222-3.299556-3.299556-7.736889-5.233778-12.515556-5.233778-4.437333 0-8.647111 1.706667-11.946666 4.664889L499.370667 505.856z"
                                                                p-id="3797"></path>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <svg t="1677641368979" class="icon" viewBox="0 0 1024 1024"
                                                            version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4953"
                                                            width="20" height="20">
                                                            <path
                                                                d="M157.568 751.296c-11.008-18.688-18.218667-31.221333-21.802667-37.909333A424.885333 424.885333 0 0 1 85.333333 512C85.333333 276.362667 276.362667 85.333333 512 85.333333s426.666667 191.029333 426.666667 426.666667-191.029333 426.666667-426.666667 426.666667a424.778667 424.778667 0 0 1-219.125333-60.501334 2786.56 2786.56 0 0 0-20.053334-11.765333l-104.405333 28.48c-23.893333 6.506667-45.802667-15.413333-39.285333-39.296l28.437333-104.288z m65.301333 3.786667l-17.258666 63.306666 63.306666-17.258666a32 32 0 0 1 24.522667 3.210666 4515.84 4515.84 0 0 1 32.352 18.944A360.789333 360.789333 0 0 0 512 874.666667c200.298667 0 362.666667-162.368 362.666667-362.666667S712.298667 149.333333 512 149.333333 149.333333 311.701333 149.333333 512c0 60.586667 14.848 118.954667 42.826667 171.136 3.712 6.912 12.928 22.826667 27.370667 47.232a32 32 0 0 1 3.338666 24.714667z m145.994667-70.773334a32 32 0 1 1 40.917333-49.205333A159.189333 159.189333 0 0 0 512 672c37.888 0 73.674667-13.173333 102.186667-36.885333a32 32 0 0 1 40.917333 49.216A223.178667 223.178667 0 0 1 512 736a223.178667 223.178667 0 0 1-143.136-51.690667z"
                                                                p-id="4954"></path>
                                                        </svg>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- 新评 -->
                        <div class="hotComment_outside" style="margin-top:50px">
                            <span class="title">新评</span>
                            <div class="comment_contain">
                                <div class="comment_line" v-for="item in comment.newComment" :key="item.commentId">
                                    <div>
                                        <img :src="item.user.avatarUrl" alt="">
                                    </div>
                                    <div>
                                        <span class="nickname">{{ item.user.nickname }}：</span>
                                        <span>{{ item.content }}</span>
                                        <!-- 被回复的评论 -->
                                        <div class="beReplieComment" v-if="item.beReplied.length > 0">
                                            <div v-for="comment in item.beReplied" :key="comment.beRepliedCommentId">
                                                <span class="nickname">@{{ comment.user.nickname }}：</span>
                                                <span>{{ comment.content }}</span>
                                            </div>
                                        </div>
                                        <!-- 评论时间 - 评论操作 -->
                                        <div>
                                            <div style="width: 50%;">
                                                {{ item.timeStr }}
                                            </div>
                                            <div class="comment_btns">
                                                <div style="display:flex;position:absolute;right:0px">
                                                    <div class="report">
                                                        举报
                                                    </div>
                                                    <div>
                                                        <span>
                                                            <svg t="1677639165647" class="icon" viewBox="0 0 1024 1024"
                                                                version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2806"
                                                                width="20" height="20">
                                                                <path
                                                                    d="M190.193225 471.411583c14.446014 0 26.139334-11.718903 26.139334-26.13831 0-14.44499-11.69332-26.164916-26.139334-26.164916-0.271176 0-0.490164 0.149403-0.73678 0.149403l-62.496379 0.146333c-1.425466-0.195451-2.90005-0.295735-4.373611-0.295735-19.677155 0-35.621289 16.141632-35.621289 36.114522L86.622358 888.550075c0 19.949354 15.96767 35.597753 35.670407 35.597753 1.916653 0 3.808746 0.292666 5.649674 0l61.022819 0.022513c0.099261 0 0.148379 0.048095 0.24764 0.048095 0.097214 0 0.146333-0.048095 0.24457-0.048095l0.73678 0 0-0.148379c13.413498-0.540306 24.174586-11.422144 24.174586-24.960485 0-13.55983-10.760065-24.441669-24.174586-24.981974l0-0.393973-50.949392 0 1.450025-402.275993L190.193225 471.409536z"
                                                                    p-id="2807"></path>
                                                                <path
                                                                    d="M926.52241 433.948343c-19.283182-31.445176-47.339168-44.172035-81.289398-45.546336-1.77032-0.246617-3.536546-0.39295-5.380544-0.39295l-205.447139-0.688685c13.462616-39.059598 22.698978-85.58933 22.698978-129.317251 0-28.349675-3.193739-55.962569-9.041934-82.542948l-0.490164 0.049119c-10.638291-46.578852-51.736315-81.31498-100.966553-81.31498-57.264215 0-95.466282 48.15065-95.466282 106.126063 0 3.241834-0.294712 6.387477 0 9.532097-2.996241 108.386546-91.240027 195.548698-196.23636 207.513194l0 54.881958-0.785899 222.227314 0 229.744521 10.709923 0 500.025271 0.222057 8.746198-0.243547c19.35686 0.049119 30.239721-4.817726 47.803749-16.116049 16.682961-10.761088 29.236881-25.50079 37.490869-42.156122 2.260483-3.341095 4.028757-7.075139 5.106298-11.20111l77.018118-344.324116c1.056052-4.053316 1.348718-8.181333 1.056052-12.160971C943.643346 476.446249 938.781618 453.944769 926.52241 433.948343zM893.82573 486.837924l-82.983993 367.783411-0.099261-0.049119c-2.555196 6.141884-6.879688 11.596106-12.872169 15.427364-4.177136 2.727111-8.773827 4.351098-13.414521 4.964058-1.49812-0.195451-3.046383 0-4.620227 0l-477.028511-0.540306-0.171915-407.408897c89.323375-40.266076 154.841577-79.670527 188.596356-173.661202 0.072655 0.024559 0.124843 0.049119 0.195451 0.072655 2.99931-9.137101 6.313799-20.73423 8.697079-33.164331 5.551436-29.185716 5.258771-58.123792 5.258771-58.123792-4.937452-37.98001 25.940812-52.965306 44.364417-52.965306 25.304316 0.860601 50.263777 33.656541 50.263777 52.326762 0 0 5.600555 27.563776 5.649674 57.190537 0.048095 37.366026-4.6673 56.847729-4.6673 56.847729l-0.466628 0c-5.872754 30.879288-16.214287 60.138682-30.464849 86.964654l0.36839 0.342808c-2.358721 4.815679-3.709485 10.220782-3.709485 15.943111 0 19.922748 19.088754 21.742187 38.765909 21.742187l238.761895 0.270153c0 0 14.666024 0.465604 14.690584 0.465604l0 0.100284c12.132318-0.638543 24.221658 5.207605 31.100322 16.409738 5.504364 9.016351 6.437619 19.6045 3.486404 28.988218L893.82573 486.837924z"
                                                                    p-id="2808"></path>
                                                                <path
                                                                    d="M264.827039 924.31872c0.319272 0.024559 0.441045 0.024559 0.295735-0.024559 0.243547-0.048095 0.367367-0.074701-0.295735-0.074701s-0.539282 0.026606-0.271176 0.074701C264.43409 924.343279 264.532327 924.343279 264.827039 924.31872z"
                                                                    p-id="2809"></path>
                                                            </svg>
                                                        </span>
                                                        <span style="transform: translateY(-5px);display: inline-block;">{{
                                                            item.likedCount
                                                        }}</span>
                                                    </div>
                                                    <div>
                                                        <svg t="1677641270520" class="icon" viewBox="0 0 1024 1024"
                                                            version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3792"
                                                            width="20" height="20">
                                                            <path
                                                                d="M785.066667 529.408c0-9.443556 5.006222-18.204444 13.198222-22.869333 8.192-4.778667 18.318222-4.778667 26.396444 0 8.192 4.778667 13.198222 13.425778 13.198223 22.869333V684.942222c0 88.177778-71.452444 159.744-159.744 159.744H345.201778C257.024 844.686222 185.457778 773.233778 185.457778 684.942222V351.914667c0-88.177778 71.452444-159.744 159.744-159.744h144.611555c14.563556 0 26.510222 11.832889 26.510223 26.396444 0 14.563556-11.832889 26.396444-26.510223 26.396445H345.201778c-28.330667 0-55.523556 11.264-75.548445 31.288888a106.876018 106.876018 0 0 0-31.288889 75.548445v333.027555c0 28.330667 11.264 55.523556 31.288889 75.548445 20.024889 20.024889 47.217778 31.288889 75.548445 31.288889h333.027555c58.936889 0 106.837333-47.786667 106.837334-106.837334V529.408z"
                                                                p-id="3793"></path>
                                                            <path
                                                                d="M678.229333 855.153778H345.201778c-93.752889 0-170.097778-76.344889-170.097778-170.097778V351.914667c0-93.752889 76.344889-170.097778 170.097778-170.097778h144.611555c20.366222 0 36.864 16.497778 36.864 36.864s-16.497778 36.864-36.864 36.864H345.201778c-25.713778 0-49.948444 10.012444-68.152889 28.216889s-28.216889 42.439111-28.216889 68.152889V684.942222c0 25.713778 10.012444 49.948444 28.216889 68.152889s42.439111 28.216889 68.152889 28.216889h333.027555c53.134222 0 96.369778-43.235556 96.369778-96.369778V529.408c0-13.084444 7.054222-25.372444 18.432-31.971556 5.575111-3.185778 11.946667-4.892444 18.432-4.892444s12.856889 1.706667 18.432 4.892444c11.377778 6.599111 18.432 18.773333 18.432 31.971556V684.942222c0 93.866667-76.231111 170.211556-170.097778 170.211556zM345.201778 202.638222c-82.261333 0-149.276444 67.015111-149.276445 149.276445V684.942222c0 82.261333 67.015111 149.276444 149.276445 149.276445h333.027555c82.261333 0 149.276444-67.015111 149.276445-149.276445V529.408c0-5.688889-3.072-11.036444-8.078222-13.880889-4.892444-2.844444-11.150222-2.844444-16.042667 0-4.892444 2.844444-7.964444 8.192-7.964445 13.880889V684.942222c0 64.625778-52.565333 117.191111-117.191111 117.191111H345.201778c-31.288889 0-60.757333-12.174222-82.830222-34.360889-22.186667-22.186667-34.360889-51.541333-34.360889-82.830222V351.914667c0-31.288889 12.174222-60.757333 34.360889-82.830223 22.186667-22.186667 51.541333-34.360889 82.830222-34.360888h144.611555c8.874667 0 16.042667-7.168 16.042667-16.042667s-7.168-16.042667-16.042667-16.042667H345.201778zM785.066667 245.191111H645.006222c-14.563556 0-26.396444-11.832889-26.396444-26.396444 0-14.563556 11.832889-26.396444 26.396444-26.396445h166.570667c14.563556 0 26.510222 11.832889 26.510222 26.396445v166.570666c0 9.443556-5.006222 18.204444-13.198222 22.869334-8.192 4.778667-18.318222 4.778667-26.396445 0-8.192-4.778667-13.198222-13.425778-13.198222-22.869334V245.191111z"
                                                                p-id="3794"></path>
                                                            <path
                                                                d="M811.463111 420.522667c-6.144 0-12.288-1.592889-17.635555-4.664889-10.808889-6.257778-17.635556-17.976889-17.635556-30.492445V253.952H645.006222c-19.456 0-35.271111-15.815111-35.271111-35.271111s15.815111-35.271111 35.271111-35.271111h166.570667c19.456 0 35.271111 15.815111 35.271111 35.271111v166.570667c0 12.515556-6.712889 24.234667-17.635556 30.492444-5.461333 3.072-11.605333 4.778667-17.749333 4.778667zM645.006222 201.045333c-9.784889 0-17.635556 7.964444-17.635555 17.635556 0 9.784889 7.964444 17.635556 17.635555 17.635555h148.821334v148.821334c0 6.257778 3.413333 12.174222 8.874666 15.36 5.347556 3.072 12.288 3.072 17.635556 0 5.461333-3.185778 8.874667-8.988444 8.874666-15.36V218.680889c0-9.784889-7.964444-17.635556-17.635555-17.635556H645.006222z"
                                                                p-id="3795"></path>
                                                            <path
                                                                d="M530.432 537.144889c-10.467556 9.671111-26.624 9.443556-36.750222-0.682667-10.126222-10.126222-10.353778-26.282667-0.682667-36.750222l299.804445-299.804444c10.467556-9.671111 26.624-9.443556 36.750222 0.682666 10.126222 10.126222 10.353778 26.282667 0.682666 36.750222L530.432 537.144889z m0 0"
                                                                p-id="3796"></path>
                                                            <path
                                                                d="M512.341333 553.073778c-9.443556 0-18.204444-3.640889-24.917333-10.353778a35.180089 35.180089 0 0 1-0.910222-48.924444l0.227555-0.227556 299.918223-299.918222 0.113777-0.113778c6.485333-6.144 15.018667-9.443556 24.007111-9.443556 9.443556 0 18.204444 3.640889 24.917334 10.353778a35.180089 35.180089 0 0 1 0.910222 48.924445l-0.227556 0.227555-299.918222 299.918222-0.113778 0.113778c-6.485333 6.030222-15.018667 9.443556-24.007111 9.443556z m-12.970666-47.217778c-6.371556 7.054222-6.257778 17.749333 0.568889 24.462222 3.299556 3.299556 7.736889 5.233778 12.515555 5.233778 4.437333 0 8.647111-1.706667 11.946667-4.664889l299.576889-299.576889c6.371556-7.054222 6.257778-17.749333-0.568889-24.462222-3.299556-3.299556-7.736889-5.233778-12.515556-5.233778-4.437333 0-8.647111 1.706667-11.946666 4.664889L499.370667 505.856z"
                                                                p-id="3797"></path>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <svg t="1677641368979" class="icon" viewBox="0 0 1024 1024"
                                                            version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4953"
                                                            width="20" height="20">
                                                            <path
                                                                d="M157.568 751.296c-11.008-18.688-18.218667-31.221333-21.802667-37.909333A424.885333 424.885333 0 0 1 85.333333 512C85.333333 276.362667 276.362667 85.333333 512 85.333333s426.666667 191.029333 426.666667 426.666667-191.029333 426.666667-426.666667 426.666667a424.778667 424.778667 0 0 1-219.125333-60.501334 2786.56 2786.56 0 0 0-20.053334-11.765333l-104.405333 28.48c-23.893333 6.506667-45.802667-15.413333-39.285333-39.296l28.437333-104.288z m65.301333 3.786667l-17.258666 63.306666 63.306666-17.258666a32 32 0 0 1 24.522667 3.210666 4515.84 4515.84 0 0 1 32.352 18.944A360.789333 360.789333 0 0 0 512 874.666667c200.298667 0 362.666667-162.368 362.666667-362.666667S712.298667 149.333333 512 149.333333 149.333333 311.701333 149.333333 512c0 60.586667 14.848 118.954667 42.826667 171.136 3.712 6.912 12.928 22.826667 27.370667 47.232a32 32 0 0 1 3.338666 24.714667z m145.994667-70.773334a32 32 0 1 1 40.917333-49.205333A159.189333 159.189333 0 0 0 512 672c37.888 0 73.674667-13.173333 102.186667-36.885333a32 32 0 0 1 40.917333 49.216A223.178667 223.178667 0 0 1 512 736a223.178667 223.178667 0 0 1-143.136-51.690667z"
                                                                p-id="4954"></path>
                                                        </svg>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </el-tab-pane>
            </el-tabs>
        </div>
    </div>
</template>

<script lang="ts">
import { defineComponent, onMounted, reactive, toRefs, watchEffect } from "vue"
import { useRouter } from "vue-router"
import type { IMusic, IMusicSheet } from "@/utils/interfaces";
import MusicForm from "@/api/apis/musicForm";
import { VideoPlay } from '@element-plus/icons-vue'
import { ElMessage } from "element-plus";
import Store from "@/utils/store"

export default defineComponent({
    setup() {
        let data = reactive({
            sheetInfo: <IMusicSheet>{},
            love_img: "/src/assets/imgs/love.png",
            activeName: "song",
            showMusicTable: <IMusic[]>[],
            showMore: true,
            comment: {
                myComment: "",
                hotComment: <any>[],
                newComment: <any>[]
            },
            msid: ""
        });

        let methods = {
            // 鼠标滑入收藏按钮
            loveHover() {
                data.love_img = "/src/assets/imgs/love_light.png";
            },
            // 鼠标滑出收藏按钮
            loveLeave() {
                data.love_img = "/src/assets/imgs/love.png";
            },
            // 收藏歌单
            loveSheet() {
                ElMessage.warning("请先登录！！");
            },
            // 补零
            repairZero(num: number) {
                if (num < 10) {
                    return "0" + num;
                } else {
                    return num;
                }
            },
            // 查看更多音乐
            showMoreMusic() {
                data.showMusicTable = data.sheetInfo.musics.slice(0, data.showMusicTable.length + 10);
            },
            // 双击单元格
            playSong(song: IMusic) {
                Store.player.playSong(song);
            },
            // 播放全部音乐，即添加进听歌列表
            playAllSong() {
                let mark = true;
                let newArr = Store.player.waitSongs;
                data.sheetInfo.musics.forEach(item => {
                    if(!newArr.find(d => d.mid == item.mid)){
                        newArr.push(item);
                    }
                    if (item.mid == Store.player.currentSong.mid) {
                        mark = false;
                    }
                });
                Store.player.waitSongs = newArr;
                if (mark) {
                    Store.player.playSong(data.sheetInfo.musics[0]);
                }
            },
            // 发表评论
            sendComment(t: number) {
                console.log(data.msid);
                MusicForm.sendComment({ t: t, type: 2, id: data.msid, content: data.comment.myComment, timestamp: new Date().getTime() }).then((res:any) => {
                    if (res.code === 200) {
                        ElMessage.success("竟然成功了！！！");
                    } else {
                        ElMessage.error("接口尚有故障，暂时关闭评论功能");
                    }
                });
            }
        };

        let events = {
            // 获取歌单详情
            getSheetInfo() {
                let router = useRouter();
                let msid = router.currentRoute.value.params.msid;
                MusicForm.getSheetInfo({ id: msid }).then((res: any) => {
                    if (res.code === 200) {
                        data.sheetInfo = <IMusicSheet>{
                            name: res.playlist.name,
                            sheetImg: res.playlist.coverImgUrl,
                            msid,
                            information: res.playlist.description,
                            tags: res.playlist.tags
                        };
                        MusicForm.getSheetMusics({ id: msid }).then((result: any) => {
                            if (result.code === 200) {
                                data.sheetInfo.musics = result.songs.map((obj: any) => {
                                    if (obj) {
                                        let author = "";
                                        obj.ar.forEach((ar: any) => {
                                            author += ar.name + " / ";
                                        })
                                        author = author.substring(0, author.length - 2);
                                        return <IMusic>{
                                            mid: obj.id,
                                            name: obj.name,
                                            author,
                                            time: obj.dt,
                                            album: obj.al.name,
                                            musicImg: obj.al.picUrl,
                                            backImg: obj.al.picUrl
                                        };
                                    }
                                });
                                data.showMusicTable = data.sheetInfo.musics.slice(0, 10);
                            }
                        })
                    }
                }).catch((err:any) => {
                    ElMessage.error("该歌单不存在");
                    router.back();
                });
            },
            // 获取歌单评论
            getSheetComment() {
                let router = useRouter();
                let msid: any = router.currentRoute.value.params.msid;
                data.msid = msid;
                MusicForm.getSheetComment({ id: msid }).then((res: any) => {
                    console.log(res , "歌单评论");
                    if (res.code === 200) {
                        data.comment.hotComment = res.hotComments;
                        data.comment.newComment = res.comments;
                    }
                });
            }
        };

        onMounted(() => {
            events.getSheetInfo();
            events.getSheetComment();
        });

        watchEffect(() => {
            if (data.showMusicTable.length >= data.sheetInfo.musics?.length) {
                data.showMore = false;
            }
        })

        return {
            ...toRefs(data),
            ...methods,
            Store
        };
    }
})

</script>

<style lang="scss" scoped>
.body {
    width: 83%;
    padding-top: 10px;
    position: absolute;
    top: 0px;
    left: 0px;
    right: 0px;
    bottom: 0px;
    margin: 0 auto;

    & .head {
        display: flex;
        width: 100%;
        height: 190px;

        &>div:nth-child(1) {
            width: 17%;
            min-width: 190px;
            height: 100%;
            border-radius: 10px;
            background-size: 100% 100%;
            background-repeat: no-repeat;
        }

        &>div:nth-child(2) {
            width: 100%;
            height: 100%;
            padding-left: 15px;
            position: relative;

            & .sheetName {
                font-weight: 600;
                line-height: 2rem;
                font-size: 1.5rem;
            }

            & .sheetTags {
                color: gray;
                cursor: pointer;
                padding-right: 10px;
                font-size: 0.1rem;

                &:hover {
                    color: lightgreen;
                }
            }

            & img {
                width: 30px;
                height: 30px;
                transform: translateY(10px);
                margin-right: 5px;
            }

            & .sheetInfo {
                font-size: 12px;
                margin-top: 10px;
                max-height: 70px;
                width: 100%;
                overflow-y: scroll;

                &::-webkit-scrollbar {
                    width: 0px;
                }
            }

            & .sheet_btn {
                position: absolute;
                bottom: 0px;

                &>button {
                    display: inline-block;
                    height: 2rem;
                    border: 0px;
                    background-color: rgba(5, 150, 105);
                    color: white;
                    border-radius: 30px;
                    width: 9rem;
                    cursor: pointer;
                    font-size: 1rem;

                    &:hover {
                        background-color: rgba(4, 120, 87);
                    }
                }

                &>button:nth-child(2) {
                    margin-left: 10px;
                    background-color: white;
                    color: black;
                    border: 1px solid rgb(160, 157, 157, 0.4);

                    &>.img {
                        width: 80px;
                        width: 20px;
                        height: 20px;
                        background-size: cover;
                        background-position: center;
                        display: inline-block;
                        margin-right: 5px;
                        transform: translateY(5px);
                    }

                    &:hover {
                        color: rgb(105, 251, 115);
                        border: 1px solid rgb(105, 251, 115);
                    }
                }

                & .more {
                    display: inline-block;
                    width: 2rem;
                    cursor: pointer;
                    height: 2rem;
                    margin-left: 10px;
                    transform: translateY(10px);
                    background-image: url('@/assets/imgs/more.png');
                    background-size: cover;

                    &:hover {
                        background-image: url('@/assets/imgs/more_light.png');
                    }
                }
            }
        }
    }

    & .comment_Outside {

.comment_contain {
    padding-top: 10px;
}

& .commentBtns {
    display: inline-block;
    padding-right: 10px;
    font-size: 1.2rem;
    cursor: default;

    &:hover {
        color: lightgreen;
    }
}

& .pushComment {
    display: inline-block;
    padding-left: 15px;
    padding-right: 15px;
    border: 1px solid gray;
    border-radius: 20px;
    cursor: pointer;
    transition: 0.1s;

    &:hover {
        background-color: rgba(0, 0, 0, 0.2);
    }
}

& .hotComment_outside {
    & .title {
        border-bottom: 4px solid green;
        display: inline-block;
        font-size: 1.5rem;
    }

    & .comment_line {
        border-bottom: 1px solid rgba(0, 0, 0, 0.2);
        display: flex;
        padding-bottom: 15px;
        padding-top: 10px;

        &>div:nth-child(1) {
            min-width: 50px;
            // padding-top: 5px;

            & img {
                width: 40px;
                height: 40px;
                margin: 0 auto;
                border-radius: 50%;
            }
        }

        &>div:nth-child(2) {
            // padding-top: 10px;
            width: 100%;

            & .nickname {
                color: rgb(38, 143, 235)
            }

            &>div {
                padding-top: 5px;
                color: gray;
                display: flex;
                font-size: 0.6rem;

                & .comment_btns {
                    width: 50%;
                    position: relative;

                    &>div>div {
                        padding-left: 15px;
                        padding-right: 15px;
                        cursor: pointer;
                        border-right: 1px solid rgba(0, 0, 0, 0.1);

                        &:hover {
                            color: lightgreen;

                            & svg {
                                fill: lightgreen;
                            }
                        }

                        &:nth-child(1) {
                            opacity: 0;
                        }
                    }
                }
            }

            &>.beReplieComment {
                margin-top: 5px;
                background-color: rgb(51, 51, 51, 0.1);
                padding: 7px;
                font-size: 0.6rem;
                border-radius: 5px;
                width: 100%;
                color: black;
            }
        }

        &:hover .report {
            opacity: 1 !important;
        }
    }
}
}
}

.musicBtns {
    opacity: 0;
    display: flex;

    &>div {
        width: 20px;
        height: 20px;
        cursor: pointer;
        background-size: cover;
        background-position: center;
        margin-left: 10px;
    }

    &>div:nth-child(1) {
        background-image: url('@/assets/imgs/sheet_play.png');

        &:hover {
            background-image: url('@/assets/imgs/sheet_play_light.png');
        }
    }

    &>div:nth-child(2) {
        background-image: url('@/assets/imgs/add.png');

        &:hover {
            background-image: url('@/assets/imgs/add_light.png');
        }
    }

    &>div:nth-child(3) {
        background-image: url('@/assets/imgs/download.png');

        &:hover {
            background-image: url('@/assets/imgs/download_light.png');
        }
    }

    &>div:nth-child(4) {
        background-image: url('@/assets/imgs/more.png');

        &:hover {
            background-image: url('@/assets/imgs/more_light.png');
        }
    }

}

// Element-plus ， 样式更改
.demo-tabs>.el-tabs__content {
    padding: 32px;
    color: #6b778c;
    font-size: 32px;
    font-weight: 600;

    & .tab {
        animation: tabs 0.2s ease-out alternate;

        & .showMore {
            text-align: center;
            color: rgb(109, 236, 109);
            font-size: 1rem;
            padding-top: 20px;
            transition: 0.2s;
            letter-spacing: 2px;

            &:hover {
                color: green;
            }
        }
    }
}

@keyframes tabs {
    0% {
        transform: translateX(100%);
        opacity: 0;
    }

    100% {
        transform: translateX(0px);
        opacity: 1;
    }
}

:deep(.el-tabs__item:hover) {
    color: #34d399;
}

:deep(.is-active) {
    color: #34d399;
}

:deep(.el-tabs__active-bar) {
    background-color: #34d399;
}

:deep(.el-table td.el-table__cell, .el-table th.el-table__cell.is-leaf) {
    border: 0px;
}

:deep(.el-table) {
    & tr:hover {
        & .musicBtns {
            opacity: 1;
        }
    }
}

:deep(.el-table__body tr.current-row > td) {
    background-color: rgb(236, 257, 246) !important;
}

:deep(.el-textarea) {
    --el-input-focus-border-color: lightgreen;
}
</style>